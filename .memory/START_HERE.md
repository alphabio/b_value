 <!-- DO NOT EDIT THIS FILE WITHOUT CONSULTING AUTHOR -->
# START_HERE.md

**CRITICAL**: This file contains ONLY timeless instructions. NO status. NO progress tracking. NO session-specific content.

## What is b_value?

Bidirectional CSS value parser. Parse CSS → IR, generate IR → CSS. Type-safe, spec-compliant.

**Scope**: Individual property values ONLY. Not shorthands.

## Every Session - Same Pattern

```bash
# 1. Create archive (ALWAYS FIRST)
mkdir -p .memory/archive/$(date +%Y-%m-%d)-[topic]/

# 2. Verify baseline
just check && just test

# 3. Work, commit frequently

# 4. Create HANDOVER.md in archive
# 5. Commit
```

**ALL session artifacts go in the dated archive directory.**

## Quality Gates (MUST PASS)

```bash
just check   # Format, typecheck, lint
just test    # All tests
```

Everything green before commit. No exceptions.

## Core Principles - NEVER VIOLATE

### DRY - Don't Repeat Yourself

**Rule**: If you write the same logic twice, extract it to `src/utils/`.

**Check**: `grep -r "function functionName" src/`. If count > 1, extract it.

**Example**: 7 parsers had `parseAlpha()`. Fixed: `src/utils/parse/color-components.ts`.

### KISS - Keep It Simple

**Rule**: Code readable in 30 seconds. One function = one job.

**Check**: Can you explain it to a junior dev in 2 minutes? If no, simplify.

### Import from Core

**Rule**: NEVER hardcode units/keywords/types.

```typescript
✅ import { ABSOLUTE_LENGTH_UNITS } from "@/core/units";
❌ const units = ["px", "em", "rem"];
```

### TypeScript Strict

**Rule**: No `any`. No `@ts-ignore`. No `@ts-expect-error`.

Handle `undefined`. Validate before use. See `tsconfig.json`.

### Library Scope

**Rule**: b_value = individual values. b_short = shorthands.

```typescript
✅ Parse "rgb(255,0,0)" → { kind: "rgb", r: 255, g: 0, b: 0 }
❌ Expand "background: red" → "background-color: red"
```

## Project Structure

```
src/
├── core/        # Import types/units/keywords from here
├── parse/       # CSS → IR parsers
├── generate/    # IR → CSS generators
└── utils/       # Extract duplication here
    ├── ast/
    ├── parse/
    └── generate/
```

## Navigation - Where Is Everything?

**Current status**: `ls -t .memory/archive/ | head -1` → Read that `HANDOVER.md`

**Current plan**: Latest archive with `MASTER_PLAN.md` or `PLAN.md`

**Code**: `src/` (self-documenting JSDoc)

**Roadmap**: `archive/2025-01-18-action-plan/ACTION_PLAN.md`

**Example refactor**: `archive/2025-01-18-checkpoint/FINAL_HANDOVER.md`

**Example DRY analysis**: `archive/2025-01-18-checkpoint/CHECKPOINT_REVIEW.md`

## Common Patterns

**Add parser**:
1. Check `src/utils/parse/` for reusable logic
2. Follow `src/parse/color/rgb.ts` pattern
3. Co-locate test: `[name].test.ts`
4. Verify round-trip: Parse → Generate → Parse

**Refactor duplication**:
1. `grep -r "function name"` to find copies
2. Extract to `src/utils/[parse|generate]/`
3. Add utility tests
4. Replace usage one file at a time
5. Test after each change
6. Commit frequently

**Debug failure**:
1. `just check && just test`
2. Read test name (descriptive)
3. Check diff (actual vs expected)
4. `git log --oneline -10` (recent changes)
5. Look for similar code in `src/utils/`

## Update Rules

**Update START_HERE.md ONLY IF**:
- Core principles changed
- Quality requirements changed
- Project structure changed
- Navigation pattern changed

**NEVER update for**:
- ❌ Test counts
- ❌ Session progress
- ❌ "Next: Session N"
- ❌ Status updates
- ❌ Recent activity

**All status goes in**: `HANDOVER.md` files in session archives.

## Import Aliases

- `@/core/*` - Types, units, keywords
- `@/utils/*` - Shared utilities
- `@/parse/*` - Parsers
- `@/generate/*` - Generators

## Testing

```bash
pnpm test              # All tests
pnpm test -- rgb       # Specific test
pnpm test -- --watch   # Watch mode
```

Tests co-located with source. Integration tests in `test/integration/`.

---

**DRY and KISS are requirements, not suggestions. Keep the codebase honest.**
